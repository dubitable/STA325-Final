---
title: "trees"
output: pdf_document
---

```{r}
library(MASS)
library(e1071)
library(car)
library(caret)
library(pROC)
library(tidymodels)
library(themis)
library(randomForest)

source("cleandata.R")
source("confusionmatrix.R")
```

```{r}
diabetes_raw <- read.csv("data/diabetes_012_health_indicators_BRFSS2015.csv")
diabetes <- cleandata(diabetes_raw)
head(diabetes)
```

```{r}
diabetes |> count(Diabetes_012)
```

```{r}
rec <- recipe(Diabetes_012 ~ ., data = diabetes) |>
  step_downsample(Diabetes_012)

rec_prep <- prep(rec)

train <- bake(rec_prep, new_data = NULL)

train |> count(Diabetes_012)
```

```{r}
rf.model <- randomForest(Diabetes_012 ~ ., data = train, importance = TRUE)
```

```{r}
pred <- predict(rf.model, newdata = diabetes)
cm <- confusionMatrix(pred, diabetes$Diabetes_012) 
plot_cm(cm)
```

